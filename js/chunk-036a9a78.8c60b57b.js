(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-036a9a78"],{"073f":function(e,t,a){},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},2226:function(e,t,a){},"28e9":function(e,t,a){"use strict";var n=a("073f"),i=a.n(n);i.a},3281:function(e,t,a){"use strict";var n=a("2226"),i=a.n(n);i.a},"34d6":function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userAssets"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"paginator"}},type:{kind:"NamedType",name:{kind:"Name",value:"PaginatorInput"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"more"}},type:{kind:"NamedType",name:{kind:"Name",value:"AssetPaginatorInput"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userAssets"},arguments:[{kind:"Argument",name:{kind:"Name",value:"paginator"},value:{kind:"Variable",name:{kind:"Name",value:"paginator"}}},{kind:"Argument",name:{kind:"Name",value:"more"},value:{kind:"Variable",name:{kind:"Name",value:"more"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file_size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updated_at"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"userCreateBatchAsset"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AssetInput"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userCreateBatchAsset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"data"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[]}]}}],loc:{start:0,end:376}};a.loc.source={body:"query userAssets($paginator: PaginatorInput\n  $more: AssetPaginatorInput) {\n  userAssets(paginator: $paginator\n    more: $more) {\n    items {\n      id,\n      name,\n      url,\n      file_size,\n      type,\n      created_at,\n      updated_at\n    },\n    cursor {\n      total\n    }\n  }\n}\n\nmutation userCreateBatchAsset($data: [AssetInput!]!) {\n  userCreateBatchAsset(data: $data)\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var a=0;a<e.definitions.length;a++){var n=e.definitions[a];if(n.name&&n.name.value==t)return n}}function o(e,t){var a={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var n=i[t]||new Set,o=new Set,r=new Set;n.forEach((function(e){r.add(e)}));while(r.size>0){var c=r;r=new Set,c.forEach((function(e){if(!o.has(e)){o.add(e);var t=i[e]||new Set;t.forEach((function(e){r.add(e)}))}}))}return o.forEach((function(t){var n=s(e,t);n&&a.definitions.push(n)})),a}(function(){a.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}}))})(),e.exports=a,e.exports["userAssets"]=o(a,"userAssets"),e.exports["userCreateBatchAsset"]=o(a,"userCreateBatchAsset")},"5c9f":function(e,t,a){"use strict";var n=a("dd79"),i=a.n(n);i.a},"841c":function(e,t,a){"use strict";var n=a("d784"),i=a("825a"),s=a("1d80"),o=a("129f"),r=a("14c3");n("search",1,(function(e,t,a){return[function(t){var a=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a):new RegExp(t)[e](String(a))},function(e){var n=a(t,e,this);if(n.done)return n.value;var s=i(e),c=String(this),l=s.lastIndex;o(l,0)||(s.lastIndex=0);var d=r(s,c);return o(s.lastIndex,l)||(s.lastIndex=l),null===d?-1:d.index}]}))},b8c2:function(e,t,a){},ca00:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("ac1f"),a("5319");function n(e){return e.replace(/GraphQL error:/,"")}},dd79:function(e,t,a){},ee27:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.show_list?a("assets",{on:{batchAdd:e.showBatch,update:e.update}}):e._e(),e.show_create?a("asset-create",{on:{cancel:e.cancelUpdate,ok:e.ok}}):e._e(),e.show_batch?a("asset-create-batch",{on:{cancel:e.cancelBatch,ok:e.ok}}):e._e()],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"relative"},[a("header",{staticClass:"padding-lr-sm padding-tb-xs flex align-center justify-between solid-bottom line-grey"},[a("bg-tag",{attrs:{active:!0}},[e._v("Asset")]),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:e.add}},[a("a-icon",{attrs:{type:"plus"}}),e._v("新增 ")],1),a("span"),a("a-button",{attrs:{type:"primary"},on:{click:e.batchAdd}},[a("a-icon",{attrs:{type:"plus"}}),e._v("上传 ")],1)],1)],1),a("div",{staticClass:"flex align-center padding-lr-sm solid-bottom line-grey",staticStyle:{height:"36px"}},[a("span",{staticClass:"margin-right-sm"},[e._v(e._s(e.select_num)+" 选中")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.select_num>0,expression:"select_num > 0"}],staticClass:"flex"},[a("bg-tag",{staticClass:"text-red"},[a("a-icon",{staticClass:"margin-right-xxs",attrs:{type:"delete"}}),e._v(" 删除 ")],1),a("bg-tag",{staticClass:"text-green"},[a("a-icon",{staticClass:"margin-right-xxs",attrs:{type:"up-square"}}),e._v(" 发布 ")],1),a("bg-tag",{staticClass:"text-yellow"},[a("a-icon",{staticClass:"margin-right-xxs",attrs:{type:"close-square"}}),e._v(" 不发布 ")],1)],1)]),e.data.length>0?a("a-table",{staticClass:"content-table",attrs:{size:"middle",rowKey:"id",rowSelection:e.rowSelection,columns:e.columns,dataSource:e.data,pagination:!1,scroll:{x:1200,y:"calc(100vh - 210px)",scrollToFirstRowOnChange:!0}},scopedSlots:e._u([{key:"url",fn:function(t,n){return[n.type.indexOf("image")>-1?a("preview-image",{attrs:{src:t,height:"30px"}}):a("span",[e._v(e._s(t))])]}}],null,!1,3701724117)}):e._e(),a("div",{staticClass:"flex justify-center margin-top-sm"},[a("a-pagination",{attrs:{showSizeChanger:"",showQuickJumper:"",total:e.total,showTotal:function(e){return"共 "+e+" 条"},pageSize:e.search.paginator.limit,defaultCurrent:1,pageSizeOptions:["10","30","50","100"]},on:{showSizeChange:e.showSizeChange}})],1),0==e.data.length?a("a-empty",{staticClass:"empty-content"}):e._e()],1)},o=[],r=(a("ac1f"),a("841c"),a("2af9")),c=a("34d6"),l=a("ca00"),d=a("4360"),u=a("a3be"),m=a("4c87"),h={name:"Contents",props:{},components:{BgTag:r["d"],PreviewImage:m["a"]},data:function(){var e=this,t=[{title:"文件名",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"预览",dataIndex:"url",scopedSlots:{customRender:"url"}},{title:"大小",dataIndex:"file_size"},{title:"上传时间",dataIndex:"created_at"}],a={onChange:function(t,a){console.log("selectedRowKeys: ".concat(t),"selectedRows: ",a),e.select_num=a.length},onSelect:function(e,t,a){console.log(e,t,a)},onSelectAll:function(e,t,a){console.log(e,t,a)}};return{rowSelection:a,columns:t,data:[],select_num:0,show_create:!1,total:30,search:{paginator:{page:1,limit:30}}}},computed:{},mounted:function(){this.getList()},methods:{add:function(){this.$emit("update")},batchAdd:function(){this.$emit("batchAdd")},showSizeChange:function(e,t){this.search.paginator.limit=t},getList:function(){var e=this,t=this;t.$apollo.query({query:c["userAssets"],variables:t.search,fetchPolicy:"no-cache",context:{uri:u["a"].projectUri+d["a"].state.common.currentProject.id}}).then((function(e){t.data=e.data.userAssets.items,t.total=e.data.userAssets.cursor.total})).catch((function(t){e.$message.warning(Object(l["a"])(t.message))}))}}},f=h,p=(a("28e9"),a("5c9f"),a("2877")),g=Object(p["a"])(f,s,o,!1,null,"ccd0d6f0",null),v=g.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-layout",{staticStyle:{"background-color":"white","margin-right":"240px"}},[a("a-layout-header",{staticClass:"header light",staticStyle:{height:"50px","line-height":"50px"}},[a("div",{staticClass:"flex align-center padding-lr-sm text-bold pointer text-black",on:{click:e.cancel}},[a("a-icon",{staticClass:"margin-right-xs",attrs:{type:"left"}}),e._v(" 新建附件 ")],1)]),a("a-layout-content",[a("div",{staticClass:"content-body padding-lr-sm"},[a("a-form-model",{ref:"form",attrs:{layout:"vertical",model:e.form}},[a("a-form-model-item",{attrs:{label:"上传",prop:"url"}},[a("area-upload",{attrs:{data:{id:1}},on:{change:e.handleChange}})],1)],1)],1)]),a("div",{staticClass:"flex justify-center margin-top"},[a("a-button",{staticClass:"margin-right",attrs:{type:"link",loading:e.submit_loading},on:{click:e.cancel}},[e._v("取消")]),a("a-button",{attrs:{type:"primary",loading:e.submit_loading},on:{click:e.handleUpload}},[e._v("创建")])],1)],1)],1)},b=[],y=(a("4160"),a("b0c0"),a("159b"),{components:{AreaUpload:r["a"]},data:function(){return{fileList:[],form:this.$form.createForm(this),submit_loading:!1}},created:function(){},methods:{cancel:function(){this.$emit("cancel")},goSchema:function(){this.$router.push({name:"Schema"})},handleChange:function(e){this.fileList=[e]},handleUpload:function(e){var t=this;e.preventDefault();var a=this;if(0!=this.fileList.length){var n=[];this.fileList.forEach((function(e){n.push({name:e.name,url:e.url,type:e.mime,file_size:e.size,is_system:"false"})})),a.$apollo.mutate({mutation:c["userCreateBatchAsset"],variables:{data:n},fetchPolicy:"no-cache",context:{uri:u["a"].projectUri+d["a"].state.common.currentProject.id}}).then((function(){t.$emit("ok")})).catch((function(e){t.$message.warning(Object(l["a"])(e.message))}))}else this.$message.warning("请上传文件")}}}),_=y,w=(a("3281"),Object(p["a"])(_,k,b,!1,null,"9866e284",null)),x=w.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-layout",{staticStyle:{"background-color":"white","margin-right":"240px"}},[a("a-layout-header",{staticClass:"header light",staticStyle:{height:"50px","line-height":"50px"}},[a("div",{staticClass:"flex align-center padding-lr-sm text-bold pointer text-black",on:{click:e.cancel}},[a("a-icon",{staticClass:"margin-right-xs",attrs:{type:"left"}}),e._v(" 批量新建附件 ")],1)]),a("a-layout-content",[a("div",{staticClass:"content-body padding-lr-sm"},[a("a-form-model",{ref:"form",attrs:{layout:"vertical",model:e.form}},[a("a-form-model-item",{attrs:{label:"上传",prop:"url"}},[a("batch-upload",{attrs:{data:{id:1}},on:{change:e.handleChange}})],1)],1)],1)]),a("div",{staticClass:"flex justify-center margin-top"},[a("a-button",{staticClass:"margin-right",attrs:{type:"link",loading:e.submit_loading},on:{click:e.cancel}},[e._v("取消")]),a("a-button",{attrs:{type:"primary",loading:e.submit_loading},on:{click:e.handleUpload}},[e._v("创建")])],1)],1)],1)},C=[],N={components:{BatchUpload:r["c"]},data:function(){return{fileList:[],form:this.$form.createForm(this),submit_loading:!1}},created:function(){},methods:{cancel:function(){this.$emit("cancel")},goSchema:function(){this.$router.push({name:"Schema"})},handleChange:function(e){this.fileList=e},handleUpload:function(e){var t=this;e.preventDefault();var a=this;if(0!=this.fileList.length){var n=[];this.fileList.forEach((function(e){n.push({name:e.name,url:e.url,type:e.mime,file_size:e.size,is_system:"false"})})),a.$apollo.mutate({mutation:c["userCreateBatchAsset"],variables:{data:n},fetchPolicy:"no-cache",context:{uri:u["a"].projectUri+d["a"].state.common.currentProject.id}}).then((function(){a.$emit("ok")})).catch((function(e){t.$message.warning(Object(l["a"])(e.message))}))}else this.$message.warning("请上传文件")}}},A=N,$=(a("f7c4"),Object(p["a"])(A,S,C,!1,null,"e3befbac",null)),j=$.exports,F={components:{Assets:v,AssetCreate:x,AssetCreateBatch:j},data:function(){return{content:{id:1},show_list:!0,show_create:!1,show_batch:!1}},computed:{},mounted:function(){},methods:{cancelUpdate:function(){this.show_list=!0,this.show_create=!1},cancelBatch:function(){this.show_batch=!1,this.show_create=!1,this.show_list=!0},showBatch:function(){this.show_batch=!0,this.show_list=!1,this.show_create=!1},ok:function(){this.show_list=!0,this.show_batch=!1,this.show_create=!1},update:function(e){this.content=e||{},this.show_create=!0,this.show_list=!1,this.show_batch=!1}}},z=F,B=Object(p["a"])(z,n,i,!1,null,"45c3ae18",null);t["default"]=B.exports},f7c4:function(e,t,a){"use strict";var n=a("b8c2"),i=a.n(n);i.a}}]);
//# sourceMappingURL=chunk-036a9a78.8c60b57b.js.map